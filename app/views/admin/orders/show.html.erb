
<div class="container">
<div class="row">
<h3>注文履歴詳細</h3>
<div class="col-xs-10">
<table class="table">
	<tr>
		<th>購入者</th>
		<td><%= @order.name %></td>
	</tr>
	<tr>
		<th>配送先</th>
		<td><%= @order.postal_code %> <%= @order.address %> <%= @order.name %></td>
	</tr>
	<tr>
		<th>支払方法</th>
		<td><%= @order.payment_method %></td>
	</tr>
	<tr>
		<th>注文ステータス</th>
		<%= form_with model: @order, url: admin_order_path(@order), method: :patch, local: true do |order| %>
		<td><%= order.select :status, Order.statuses.keys %></td>

		<!-- 		dbから持ってくる場合はcollection_selectを使う。enumはcollectionいらない -->

		<td><%= order.submit "更新",class: "btn btn-primary" %></td>
		<% end %>
	</tr>
</table>
</div>
</div>

<div class="row">
	<div class="col-xs-7">

<table class="table">
	<thead>
		<tr>
			<th>商品名</th>
			<th>単価（税込）</th>
			<th>数量</th>
			<th>小計</th>
			<th>製作ステータス</th>
			<th></th>
		</tr>
	</thead>



	<tbody>
		<% @order.order_details.each do |order_detail| %>
		<%= form_with model: [order_detail.order, order_detail],url: admin_order_order_detail_path(order_id: order_detail.order.id, id: order_detail.id), method: :patch, local: true do |order| %>
		<tr>
			<td><%= order_detail.item.name %></td>
			<td><%= order_detail.item.price %></td>
			<td></td>
			<td><%= order_detail.price.to_i * order_detail.amount.to_i %></td>
			<td>
				<%= order.select :making_status, OrderDetail.making_statuses.keys.to_a, {prompt: "選択してください"} %>
			</td>
			<td><%= order.submit "更新",class: "btn btn-primary" %></td>
		</tr>
		<% end %>
		<% end %>
	</tbody>
</table>
</div>
<div class="col-offset-1 col-xs-4">
	<table class="table">
		<tr>
			<th>商品合計</th>
			<td><%= @order.total_payment %></td>
		</tr>
		<tr>
			<th>送料</th>
			<td><%= @order.shipping_cost %></td>
		</tr>
		<tr>
			<th>請求金額合計</th>
			<td><%= @order.total_payment + @order.shipping_cost %></td>
		</tr>
	</table>
</div>
</div>